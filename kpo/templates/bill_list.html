{% extends "layout.html" %}
{% block content %}
<div>
  <a class="btn btn-info btn-sm m-1" href="{{ url_for('bills.register_b') }}">Kreirajte novu fakturu</a>
  <hr class="mb-3">
</div>
<h2 class="">Izlazni dokumenti</h2>
<table id="data" class="table table-striped dataTable no-footer invoices" role="grid" aria-describedby="data_info" style="width: 968px;">
  <thead>
      <tr role="row">
          <th>Br dokumenta</th>
          <th>Tip dokumenta</th>
          <th>Komitent</th>
          <th>Iznos</th>
          <th>Datum prometa</th>
          <th>Datum dospeÄ‡a</th>
      </tr>
  </thead>
  <tbody>
      {% for bill in bills %}
      <tr>
          <td>
            <div class="btn-group">
              <a class="btn btn-primary btn-sm" href="{{ url_for('bills.bill_profile', bill_id=bill.id) }}" title="Izmenite dokument">{{ bill.bill_number }} </a>
              <a class="btn btn-danger btn-sm" href="#" title="Preuzmite dokument"><i class="fa-solid fa-down-long"></i></a>
            </div>
          </td>
          <td>{{ bill.bill_type }}</td>
          <td><a class="btn btn-info btn-sm mr-2" href="{{ url_for('customers.customer_profile', customer_id=bill.bill_customer.id) }}">{{ bill.bill_customer.customer_name }}</a></td>
          <td>{{ bill.total_price }}</td>
          <td>{{ bill.bill_transaction_date }}</td>
          <td>{{ bill.bill_due_date }}</td>
      </tr>
      {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <th colspan="3" style="text-align:right"></th>
      <th></th>
    </tr>
  </tfoot>
</table>

{% endblock content%}

{% block scripts  %}
<script>
  $(document).ready(function () {
  $('#data').DataTable({
    footerCallback: function (row, data, start, end, display) {
      var api = this.api();

      // Remove the formatting to get integer data for summation
      var intVal = function (i) {
          return typeof i === 'string' ? i.replace(/[\$,]/g, '') * 1 : typeof i === 'number' ? i : 0;
      };

      // Total over all pages
      total = api
          .column(3)
          .data()
          .reduce(function (a, b) {
              return intVal(a) + intVal(b);
          }, 0);

      // Total over this page
      pageTotal = api
          .column(3, { page: 'current' })
          .data()
          .reduce(function (a, b) {
              return intVal(a) + intVal(b);
          }, 0);

      // Update footer
      $(api.column(3).footer()).html(pageTotal + ' (' + total + ' total)');
    },
    language: {
      url: "//cdn.datatables.net/plug-ins/1.12.1/i18n/sr-SP.json"
    },
    stateSave: true,
    });
  });
</script>
{% endblock %}
